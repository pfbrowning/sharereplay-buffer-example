# The RXJS ShareReplay Operator Never Clears Its Buffer

(ShareReplay)[https://www.learnrxjs.io/operators/multicasting/sharereplay.html] is an RXJS operator which is very useful for managing expensive observable operations that you only want to perform once for the duration of the application, such as fetching global application data from an API backend.  It works by multicasting the observable so that the operation is not duplicated for concurrent subscribers and then storing the result in a (ReplaySubject)[https://xgrommx.github.io/rx-book/content/subjects/replay_subject/index.html] in order to replay the result to future subscribers without having to perform the operation again.  It also uses (refCount)[https://blog.angularindepth.com/rxjs-how-to-use-refcount-73a0c6619a4e] to unsubscribe from the source observable once the number of subscribers reaches zero.

One important thing to understand about ShareReplay, however, is that ShareReplay does not clear its underlying ReplaySubject (and, by extension, the previously emitted values in the buffer) when the subscriber count reaches zero.  I recently ran into some confusion about this due to conflicting information on the internet, so I'd like to clarify that here for anybody else who runs into the same issue.

One of the first few articles that I came across while learning about ShareReplay and related operators was [this](https://medium.com/@_achou/rxswift-share-vs-replay-vs-sharereplay-bea99ac42168) one, which states near the end that "When the reference count of subscribers drops to zero, the replay buffer is cleared."  This threw me off when my ShareReplay operators were continuing to emit previously-emitted values after all of my subscribers had unsubscribed.

Upon further research I came across (this)[https://github.com/ReactiveX/rxjs/issues/3336] issue on Github which discusses the operation of ShareReplay in depth and (this)[https://github.com/ReactiveX/rxjs/issues/3336#issuecomment-404684615] comment in particular, which explains that the ReplaySubject is reused by design, and that if you want the buffer to be cleared when the subscriber count reaches zero "you need to pass a factory to multicast".  We can confirm this by reading the (ShareReplay source code)[https://github.com/ReactiveX/rxjs/blob/master/src/internal/operators/shareReplay.ts]: the underlying ReplaySubject is never actually cleared out or recreated after initial creation.  This is a critical detail.